% !TEX root = ../paper.tex
\documentclass{standalone}
\input{macros}
\begin{document}
\footnotesize


\[ \inferrule[\texttt{wp\_br}]{
  (\xxWlfilled{k}{\mathit{lh}}{\mathit{vs}\cat\xxWbr{k}}{\mathit{les}})\ast{}(|\V{vs}|=n)\ast{} \frameR F \ast{}\later\left(\frameR F\wand \wpre{(\mathit{vs} \cat \mathit{es})}{\mathit{w}, \Phi(\mathit{w})}\right)
}{
  \wpre{\xxWlabel{n}{\mathit{es}}{\mathit{les}}}{\mathit{w}, \Phi(\mathit{w})}
} \]
%\inferrule[\texttt{wp\_br}]{
%  |\V{vs}| = n \ast{} \xxWlfilled{i}{\V{lh}}{(\V{vs}\cat\xxWbr{i})}{\V{les}} \ast{} \frameR{F} \ast{}\\
%   \later\left[ \frameR{F} \wand \wpre{(\V{vs} \cat \V{es})}{w, \Phi(w)}\right]
%}{
%  \wpre{\xxWlabel{n}{\V{es}}{\V{les}}}{w, \Phi(w)}
%}

\[ \inferrule[\texttt{wp\_return}]{
   (\xxWlfilled{i}{lh}{(\V{vs} \cat \xxWreturn)}{\V{les}}) \ast{} (|\V{vs}| = n) \ast{} 
  \later \left[\wpre{(\V{vs} \cat \V{es})}{w, \Phi(w) \ast{} \frameR{F}}\right]
}{
  \wpre{\xxWlocal{n}{F_0}{\V{les}}}{w, \Phi(w) \ast{} \frameR{F}}
} \]


\[ \inferrule[\texttt{wp\_block}]{
|\V{vs}| = |\V{ts}_1| \ast{} \frameR{F} \ast{}
   \later\left[ \frameR{F} \wand \wpre{\xxWlabel{|\V{ts}_2|}{[]}{(\V{vs} \cat \V{es})}}{w, \Phi(w)}\right]
}{
  \wpre{(\V{vs} \cat \xxWblock~(\V{ts}_1\to\V{ts}_2)~\V{es})}{w, \Phi(w)}
} \]


\[ \inferrule[\texttt{wp\_loop}]{
   |\V{vs}| = |\V{ts}_1| \ast{} \frameR{F} \ast{} \\
   \later\left[ \frameR{F} \wand \wpre{(\xxWlabel{|\V{ts}_1|}{\left[\xxWloop~(\V{ts}_1\to\V{ts}_2)~\V{es}\right]}{(\V{vs} \cat \V{es})}) }{w, \Phi(w)}\right]
}{
  \wpre{(\V{vs} \cat \xxWloop~(\V{ts}_1\to\V{ts}_2)~\V{es})}{w, \Phi(w)}
} \]


\[ \inferrule[\texttt{wp\_if\_true}]{
  \V{c} \neq 0 \ast{} \frameR{F} \ast{}
   \later\left[ \frameR{F} \wand \wpre{\left[\xxWblock~\V{ft}~\V{es}_1\right]}{w, \Phi(w)}\right]
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWif~\V{ft}~\V{es}_1~\V{es}_2\right]}{w, \Phi(w)}
} \]


\[ \inferrule[\texttt{wp\_if\_false}]{
  \V{c} = 0 \ast{} \frameR{F} \ast{}
   \later\left[ \frameR{F} \wand \wpre{\left[\xxWblock~\V{ft}~\V{es}_2\right]}{w, \Phi(w)}\right]
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWif~\V{ft}~\V{es}_1~\V{es}_2\right]}{w, \Phi(w)}
} \]



\[ \inferrule[\texttt{wp\_br\_if\_true}]{
  \V{c} \neq 0 \ast{} \frameR{F} \ast{}
   \later\left[ \frameR{F} \wand \wpre{\left[\xxWbr~\V{i}\right]}{w, \Phi(w)}\right]
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWbrif~\V{i}\right]}{w, \Phi(w)}
} \]



\[ \inferrule[\texttt{wp\_br\_if\_false}]{
  \V{c} = 0 \ast{} \frameR{F} \ast{} \later \Phi(\immV{[]})
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWbrif~\V{i}\right]}{w, \Phi(w)\ast{}\frameR F}
} \]


\[ \inferrule[\texttt{wp\_br\_table}]{
  \V{iss}[c] = \V{j} \ \ast{} \frameR{F} \ast{}
  \later\left[ \frameR{F} \wand \wpre{\left[\xxWbr~\V{j}\right]}{w, \Phi(w)}\right]
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWbrtable~\V{iss}~\V{i}\right]}{w, \Phi(w)}
} \]


\[ \inferrule[\texttt{wp\_br\_table\_length}]{
  |\V{iss}| \leq \V{c} \ast{} \frameR{F} \ast{}
  \later\left[ \frameR{F} \wand \wpre{\left[\xxWbr~\V{i}\right]}{w, \Phi(w)}\right]
}{
  \wpre{(\left[\xxWeconstt{\xxWithirtytwo}{c}; \xxWbrtable~\V{iss}~\V{i}\right]}{w, \Phi(w)}
} \]

%\vspace{0.1cm}

%\inferrule[\texttt{wp\_label\_value}]{
 % (\xxWisconst{\V{vs}} \ast{} \frameR{F} \ast{} \later \Phi(\immV{\V{vs}})
%}{
 % \wpre{\xxWlabel{m}{\V{es}}{\V{vs}}}{w, \Phi(w) \ast{} \frameR{F}}
%}

%\rao{Currently ignoring all the ctx versions of the proof rules, as there are too many of them, and these plain proof rules are sufficient to capture the spirits. We have to refer people to the Coq code at some point. }
\end{document}
